<html>
	<head>
		<style>
			body { margin-left: 10%; }
			canvas { width: 100%; height: 100% }
		</style>
	</head>
	<body>
		<script src="three.min.js"></script>
		<script src="TrackballControls.js"></script>
		<script src="helper.js"></script>

    <!-- Custom Shader Code -------------------------->
    <script id="vertexShader" type="x-shader/x-vertex">
    varying vec3 vNormal;
    void main()
    {
        vNormal = normalize( normalMatrix * normal );
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
    }
    </script>

    <!-- fragment shader a.k.a. pixel shader -->
    <script id="fragmentShader" type="x-shader/x-vertex">
    	varying vec3 vNormal;
			uniform vec3 color;

    void main()
    {
      float intensity = pow( 0.7 - dot( vNormal, vec3( 0.0, 0.0, 0.8 ) ), 2.0 );
        gl_FragColor = vec4( color, 1.0 ) * intensity;
    }
    </script>
    <!--------------------------------------------------------------->
    <h1> Заглавие </h1>
		<script>
			var renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth/2, window.innerHeight/2 );
			document.body.appendChild( renderer.domElement );
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera( 30, window.innerWidth/window.innerHeight, 0.1, 1000 );
			camera.position.set(0,0,8);
			camera.lookAt(new THREE.Vector3(0,0,0));

			//controling with the mouse
			var controls = new THREE.TrackballControls( camera,  renderer.domElement );
			controls.rotateSpeed = 1.0;
			controls.zoomSpeed = 1.2;
			controls.panSpeed = 0.8;
			controls.noZoom = false;
			controls.noPan = false;
			controls.staticMoving = true;
			controls.dynamicDampingFactor = 0.3;

			//main sphere
			var geometry = new THREE.SphereGeometry( 1, 32, 32 );
			geometry.dynamic = true;
			var texture = new THREE.ImageUtils.loadTexture( 'img8.jpg' );
			var material1 = new THREE.MeshBasicMaterial( { map: texture } );
      sphere = new THREE.Mesh( geometry, material1);
      scene.add( sphere );

			var previous = [];
			for (var i=0; i<geometry.vertices.length; i++)
			{
				previous[i] = 1;
			}

			//sample static sphere
			var geometry3 = new THREE.SphereGeometry( 1, 8, 8 );
			var material2 = new THREE.MeshPhongMaterial({color:'goldenrod', transparent: true, opacity: 0.2, wireframe: true});
			sphere2 = new THREE.Mesh( geometry3, material2);
			sphere2.position.set(3.5, 0, 0);
      scene.add( sphere2 );

			//ambient light
			scene.add( new THREE.AmbientLight('white',2) );

      // shader for the glow
      var customMaterial = new THREE.ShaderMaterial(
      {
        uniforms: { color: {type: "c", value: new THREE.Color("rgb(0, 0, 0)")}},
        vertexShader:   document.getElementById( 'vertexShader'   ).textContent,
        fragmentShader: document.getElementById( 'fragmentShader' ).textContent,
        blending: THREE.AdditiveBlending,
				depthWrite: 	false,
				polygonOffset: true,
				polygonOffsetFactor: -10,
				polygonOffsetUnits: 100,
        transparent: true
      }   );
      var ballGeometry = new THREE.SphereGeometry( 1.1, 32, 16 );
			ballGeometry.dynamic = true;
      var ball = new THREE.Mesh( ballGeometry, customMaterial );
      scene.add( ball );

			//---------------------------------------------------
			var customMaterial2 = new THREE.ShaderMaterial(
			{
				uniforms: { color: {type: "c", value: new THREE.Color("rgb(0, 0, 0)")}},
				vertexShader:   document.getElementById( 'vertexShader'   ).textContent,
				fragmentShader: document.getElementById( 'fragmentShader' ).textContent,
				side: THREE.BackSide,
				blending: THREE.AdditiveBlending,
				transparent: true
			}   );

			var ballGeometry2 = new THREE.SphereGeometry( 1.2, 32, 16 );
			var ball2 = new THREE.Mesh( ballGeometry2, customMaterial2 );
			scene.add( ball2 );
			//----------------------------------------------
			var previous2 = [];

			for (var i=0; i<ballGeometry.vertices.length; i++)
			{
				previous2[i] = 1;
			}

      var t = 0;
      function drawFrame()
			{
				requestAnimationFrame( drawFrame );

        if (animate) animate(t++);
				controls.update();
				renderer.render( scene, camera );
			}

			drawFrame();
      showValue(1000);
		</script>
    <br>
		<br>
    <input type="range" min="1000" max="40000" value="1000" step="5" oninput="showVal(this.value)" onchange="showValue(this.value)" />
    <span id="range">1000</span>
    <br>
	</body>
</html>
